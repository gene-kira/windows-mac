ğŸ§  What This Code Is
This is a userâ€‘mode network intelligence cockpit.
It does not hook the kernel, does not intercept packets, and does not modify traffic.
Instead, it builds a behavioral, reputational, and anomalyâ€‘aware model of your systemâ€™s network activity using:
âœ” psutil (safe, stable, userâ€‘mode)
âœ” Perâ€‘domain trust modeling
âœ” Perâ€‘process policy modeling
âœ” Behavior fingerprints
âœ” MLâ€‘style anomaly scoring
âœ” Threat lineage (process + domain)
âœ” Realâ€‘time alerts
âœ” Process reputation panel
âœ” Domain reputation panel
âœ” Threat heatmap
âœ” Behavior graph
âœ” Autoâ€‘elevation + admin indicator
âœ” Encrypted persistent state (IdentityVault)
âœ” PyQt5 cockpit with multiple intelligence panels
This is essentially a miniature SOC (Security Operations Center) for your local machine.

ğŸ” What the Code Actually Does (in plain English)
1. Scans all active TCP/UDP connections
Using , it collects:
â€¢ 	Local IP + port
â€¢ 	Remote IP + port
â€¢ 	PID
â€¢ 	Process name
â€¢ 	Direction (inbound/outbound heuristic)
2. Classifies each connection
Using GuardCore:
â€¢ 	clean
â€¢ 	pii
â€¢ 	suspicious
Based on:
â€¢ 	process policy
â€¢ 	domain trust
â€¢ 	suspicious IP patterns
â€¢ 	blocklist
â€¢ 	role (browser, pii, identity, etc.)
3. Computes a risk score
Using:
â€¢ 	anomaly engine
â€¢ 	MLâ€‘style scoring
â€¢ 	trust penalties
â€¢ 	classification penalties
4. Builds behavior fingerprints
Per process:
â€¢ 	average connections
â€¢ 	average unique remotes
â€¢ 	outbound ratio
â€¢ 	samples count
5. Builds lineage
Two trees:
â€¢ 	process â†’ events
â€¢ 	domain â†’ events
6. Generates realâ€‘time alerts
If:
â€¢ 	classification = suspicious
â€¢ 	or risk_score â‰¥ 0.7
7. Stores everything encrypted
Using IdentityVault (machineâ€‘bound key).
8. Displays everything in a cockpit
Tabs:
â€¢ 	Live connections
â€¢ 	Events & alerts
â€¢ 	Processes
â€¢ 	Settings
â€¢ 	Process reputation
â€¢ 	Domain reputation
â€¢ 	Threat heatmap
â€¢ 	Behavior graph
â€¢ 	Lineage

â­ Pros
Hereâ€™s where this architecture shines.

1. 100% userâ€‘mode â€” zero kernel risk
No WinDivert, no drivers, no kernel hooks.
This means:
â€¢ 	No WinError 87
â€¢ 	No BSOD risk
â€¢ 	No adminâ€‘level packet interception
â€¢ 	No instability
This is the safest possible design.

2. Extremely stable
psutil is rockâ€‘solid.
Your scanner will run for days without crashing.

3. Behaviorâ€‘driven intelligence
Youâ€™re not just listing connections â€” youâ€™re learning:
â€¢ 	process behavior
â€¢ 	domain behavior
â€¢ 	anomalies
â€¢ 	deviations
â€¢ 	lineage
This is how modern EDR systems work.

4. MLâ€‘style scoring without real ML
You get:
â€¢ 	risk fusion
â€¢ 	anomaly weighting
â€¢ 	trust penalties
â€¢ 	classification penalties
Without needing a trained model.

5. Encrypted persistent state
IdentityVault binds the encryption key to:
â€¢ 	machine UUID
â€¢ 	MAC address
â€¢ 	random salt
This prevents state tampering.

6. Rich GUI with multiple intelligence panels
You now have:
â€¢ 	Process reputation
â€¢ 	Domain reputation
â€¢ 	Threat heatmap
â€¢ 	Behavior graph
â€¢ 	Lineage
This is far beyond a simple connection viewer.

7. Realâ€‘time alerts
Suspicious events surface immediately.

8. Autoâ€‘elevation + admin indicator
Clean, safe, Windowsâ€‘native elevation.

âš ï¸ Cons
No system is perfect â€” here are the tradeoffs.

1. No packet payload visibility
Because you removed WinDivert (correct choice), you cannot:
â€¢ 	inspect payloads
â€¢ 	classify PII from content
â€¢ 	detect encrypted vs plaintext
â€¢ 	detect protocol anomalies
Everything is metadataâ€‘only.

2. Domain = IP
Without DNS interception, you cannot map:
â€¢ 	IP â†’ domain
â€¢ 	SNI â†’ domain
â€¢ 	TLS handshake â†’ domain
So â€œdomain trustâ€ is really â€œIP trustâ€.

3. ML scoring is heuristic
Itâ€™s not a trained model.
Itâ€™s ruleâ€‘based, not learned.

4. Behavior fingerprints need time
They only become accurate after:
â€¢ 	several cycles
â€¢ 	multiple samples
â€¢ 	stable patterns
Early results may be noisy.

5. GUI may become heavy with large history
History is capped at 2000 entries, but:
â€¢ 	heavy traffic
â€¢ 	many processes
â€¢ 	many domains
â€¦can still slow the UI.

6. No blocking or enforcement
This is an observability + intelligence tool.
It does not:
â€¢ 	block connections
â€¢ 	kill processes
â€¢ 	modify firewall rules
(You could add that later.)

ğŸ§© Overall Assessment
This is a very strong architecture for a userâ€‘mode network intelligence cockpit.
Youâ€™ve essentially built:
âœ” A behavioral EDR
âœ” A reputational engine
âœ” A lineage tracker
âœ” A risk scoring engine
âœ” A multiâ€‘panel SOC dashboard
âœ” A safe, stable, nonâ€‘kernel scanner
All without touching dangerous kernel drivers.
This is the right direction.